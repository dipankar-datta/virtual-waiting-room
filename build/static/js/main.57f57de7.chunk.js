(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{16:function(e,t,c){},26:function(e,t,c){},36:function(e,t,c){"use strict";c.r(t);var r=c(0),a=c.n(r),s=c(20),n=c.n(s),i=(c(26),c(9)),o=c(10),l=c(12),h=c(11),d=(c(16),c(2)),j=c(1),b=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(){return Object(i.a)(this,c),t.apply(this,arguments)}return Object(o.a)(c,[{key:"render",value:function(){return Object(j.jsx)("div",{className:"horizontal-center",children:Object(j.jsx)("h2",{})})}}]),c}(a.a.Component),u=c(7),O=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(e){var r;return Object(i.a)(this,c),(r=t.call(this,e)).STRESS_CHECK_PATH="/api/can_serve",r.RECHECK_PERIOD=5,r.intervalRef=void 0,r.redirectBack=function(){r.state.redirectUrl&&(clearInterval(r.intervalRef),window.location.replace(r.state.redirectUrl))},r.checkApplicationStressStatus=function(){if(r.state.recheckPeriod>0)r.setState(Object(u.a)(Object(u.a)({},r.state),{},{recheckPeriod:r.state.recheckPeriod-1}));else if(0===r.state.recheckPeriod){var e=r.state.redirectHostname+r.STRESS_CHECK_PATH;fetch(e).then((function(e){e.json().then((function(e){e?(clearInterval(r.intervalRef),r.redirectBack()):r.setErrorMessage("busy")}))})).catch((function(e){r.setErrorMessage("failed")}))}},r.setErrorMessage=function(e){var t,c=Object.assign([],r.state.recheckMessages),a=c.length+1+" - Last checked at: "+(new Date).toLocaleTimeString()+" - Status: "+e.toUpperCase();switch(e){case"failed":t="alert alert-danger";break;case"busy":t="alert alert-info";break;case"success":t="alert alert-success"}var s=Object(j.jsx)("div",{className:t,role:"alert",children:a});c.push(s),r.setState(Object(u.a)(Object(u.a)({},r.state),{},{recheckMessages:c,recheckPeriod:r.RECHECK_PERIOD}))},r.stopRecheck=function(){clearInterval(r.intervalRef),r.setState(Object(u.a)(Object(u.a)({},r.state),{},{rechecking:!1}))},r.startRecheck=function(){r.intervalRef=setInterval(r.checkApplicationStressStatus,1e3),r.setState(Object(u.a)(Object(u.a)({},r.state),{},{rechecking:!0,recheckPeriod:r.RECHECK_PERIOD}))},r.state={recheckPeriod:r.RECHECK_PERIOD,recheckMessages:[],rechecking:!0,resourceStatus:"busy"},r}return Object(o.a)(c,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search).get("redirectInfo");e&&(e=atob(e),e=JSON.parse(e));var t=e.redirectUrl,c=e.appCheckStatus,r=new URL(t).origin;this.setState(Object(u.a)(Object(u.a)({},this.state),{},{redirectUrl:t,resourceStatus:c,redirectHostname:r})),this.startRecheck()}},{key:"render",value:function(){return Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{children:[Object(j.jsxs)("h3",{children:["Resource ","unavailable"===this.state.resourceStatus?"Unavailable":"Busy"]}),Object(j.jsxs)("p",{children:["Your requested application is currently ",this.state.resourceStatus,". Once the requested application is available, you will be redirected back."]})]}),Object(j.jsxs)("h6",{children:["Requested application URL: ",this.state.redirectUrl]}),Object(j.jsxs)("div",{className:"horizontal-center",style:{padding:"20px"},children:[Object(j.jsxs)("div",{className:"horizontal-center",children:[Object(j.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.redirectBack,children:"Go Back"})," \xa0\xa0",this.state.rechecking?Object(j.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.stopRecheck,children:"Stop Recheck"}):Object(j.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.startRecheck,children:"Start Recheck"})]}),Object(j.jsx)("div",{className:"horizontal-center",children:Object(j.jsx)("h6",{children:"Only for demonstration"})})]}),this.state.rechecking?Object(j.jsxs)("h6",{children:["Next Application status check in - ",this.state.recheckPeriod," seconds"]}):"",this.state.recheckMessages.length>0?Object(j.jsx)("div",{style:{marginTop:"20px"},children:Object(j.jsx)("table",{children:Object(j.jsx)("tbody",{children:this.state.recheckMessages.slice().reverse().map((function(e){return Object(j.jsx)("tr",{children:Object(j.jsx)("td",{children:e})})}))})})}):""]})}}]),c}(a.a.Component),p=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(){return Object(i.a)(this,c),t.apply(this,arguments)}return Object(o.a)(c,[{key:"render",value:function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{style:{backgroundColor:"black",height:"55px"},children:Object(j.jsx)("div",{className:"horizontal-center",children:Object(j.jsx)("h3",{style:{color:"cornsilk",marginTop:"10px"},children:"Virtual Waiting Room"})})}),Object(j.jsx)("div",{style:{padding:"20px 20px"},children:Object(j.jsxs)(d.c,{children:[Object(j.jsx)(d.a,{path:"/",exact:!0,component:b}),Object(j.jsx)(d.a,{path:"/wait",component:O})]})})]})}}]),c}(a.a.Component),k=c(17);n.a.render(Object(j.jsx)(k.a,{children:Object(j.jsx)(p,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.57f57de7.chunk.js.map