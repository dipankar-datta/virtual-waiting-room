(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{16:function(e,t,c){},26:function(e,t,c){},36:function(e,t,c){"use strict";c.r(t);var a=c(0),s=c.n(a),r=c(20),n=c.n(r),i=(c(26),c(9)),o=c(10),l=c(12),h=c(11),j=(c(16),c(2)),b=c(1),d=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(){return Object(i.a)(this,c),t.apply(this,arguments)}return Object(o.a)(c,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"horizontal-center",children:Object(b.jsx)("h2",{})})}}]),c}(s.a.Component),u=c(3),O=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(e){var a;return Object(i.a)(this,c),(a=t.call(this,e)).STRESS_CHECK_PATH="/api/can_serve",a.RECHECK_PERIOD=5,a.intervalRef=void 0,a.redirectBack=function(){a.state.redirectUrl&&(clearInterval(a.intervalRef),window.location.replace(a.state.redirectUrl))},a.checkApplicationStressStatus=function(){if(a.state.recheckPeriod>0)a.setState(Object(u.a)(Object(u.a)({},a.state),{},{recheckPeriod:a.state.recheckPeriod-1}));else if(0===a.state.recheckPeriod&&"start"===a.state.rechecking){a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"checking"}));var e=a.state.redirectHostname+a.STRESS_CHECK_PATH;fetch(e).then((function(e){e.ok?e.json().then((function(e){e?(clearInterval(a.intervalRef),a.redirectBack()):(a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"start"})),a.setErrorMessage("busy"))})):(a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"start"})),a.setErrorMessage("failed"))})).catch((function(e){a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"start"})),a.setErrorMessage("failed")}))}},a.setErrorMessage=function(e){var t,c=Object.assign([],a.state.recheckMessages),s=c.length+1+" - Last checked at: "+(new Date).toLocaleTimeString()+" - Status: "+e.toUpperCase();switch(e){case"failed":t="alert alert-danger";break;case"busy":t="alert alert-info";break;case"success":t="alert alert-success"}var r=Object(b.jsx)("div",{className:t,role:"alert",children:s});c.push(r),a.setState(Object(u.a)(Object(u.a)({},a.state),{},{recheckMessages:c,recheckPeriod:a.RECHECK_PERIOD}))},a.stopRecheck=function(){clearInterval(a.intervalRef),a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"stop"}))},a.startRecheck=function(){a.intervalRef=setInterval(a.checkApplicationStressStatus,1e3),a.setState(Object(u.a)(Object(u.a)({},a.state),{},{rechecking:"start",recheckPeriod:a.RECHECK_PERIOD}))},a.clearLog=function(){a.setState(Object(u.a)(Object(u.a)({},a.state),{},{recheckMessages:[]}))},a.state={recheckPeriod:a.RECHECK_PERIOD,recheckMessages:[],rechecking:"start",resourceStatus:"busy"},a}return Object(o.a)(c,[{key:"componentDidMount",value:function(){var e=this,t=new URLSearchParams(this.props.location.search).get("redirectInfo");t&&(t=atob(t),t=JSON.parse(t));var c=t.redirectUrl,a=t.appCheckStatus,s=new URL(c).origin;setTimeout((function(){e.setState(Object(u.a)(Object(u.a)({},e.state),{},{redirectUrl:c,resourceStatus:a,redirectHostname:s})),e.startRecheck()}),200)}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{children:[Object(b.jsxs)("h3",{children:["Resource ","unavailable"===this.state.resourceStatus?"Unavailable":"Busy"]}),Object(b.jsxs)("p",{children:["Your requested application is currently ",this.state.resourceStatus,". Once the requested application is available, you will be redirected back."]})]}),Object(b.jsxs)("h6",{children:["Requested application URL: ",this.state.redirectUrl]}),Object(b.jsxs)("div",{className:"horizontal-center",style:{padding:"20px"},children:[Object(b.jsxs)("div",{className:"horizontal-center",children:[Object(b.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.redirectBack,children:"Go Back"})," \xa0\xa0",["start","checking"].indexOf(this.state.rechecking)>=0?Object(b.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.stopRecheck,children:"Stop Recheck"}):Object(b.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.startRecheck,children:"Start Recheck"}),"\xa0\xa0",Object(b.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.clearLog,children:"Clear Log"})]}),Object(b.jsx)("div",{className:"horizontal-center",children:Object(b.jsx)("h6",{children:"Only for demonstration"})})]}),"start"===this.state.rechecking?Object(b.jsxs)("h6",{children:["Next Application status check in - ",this.state.recheckPeriod," seconds"]}):"","checking"===this.state.rechecking?Object(b.jsx)("h6",{children:"Checking application"}):"",this.state.recheckMessages.length>0?Object(b.jsx)("div",{style:{marginTop:"20px"},children:Object(b.jsx)("table",{children:Object(b.jsx)("tbody",{children:this.state.recheckMessages.slice().reverse().map((function(e){return Object(b.jsx)("tr",{children:Object(b.jsx)("td",{children:e})})}))})})}):""]})}}]),c}(s.a.Component),k=function(e){Object(l.a)(c,e);var t=Object(h.a)(c);function c(){return Object(i.a)(this,c),t.apply(this,arguments)}return Object(o.a)(c,[{key:"render",value:function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{backgroundColor:"black",height:"55px"},children:Object(b.jsx)("div",{className:"horizontal-center",children:Object(b.jsx)("h3",{style:{color:"cornsilk",marginTop:"10px"},children:"Virtual Waiting Room"})})}),Object(b.jsx)("div",{style:{padding:"20px 20px"},children:Object(b.jsxs)(j.c,{children:[Object(b.jsx)(j.a,{path:"/",exact:!0,component:d}),Object(b.jsx)(j.a,{path:"/wait",component:O})]})})]})}}]),c}(s.a.Component),p=c(17);n.a.render(Object(b.jsx)(p.a,{children:Object(b.jsx)(k,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.8c2aee4d.chunk.js.map